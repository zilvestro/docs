---
title: 'Embedded Referral Dashboard'
description: 'Display affiliate dashboards directly in your application'
---

Integrate a fully functional referral dashboard into your product. Your users see their stats, referral links, and earnings - all within your app's interface.

## Overview

The embedded dashboard displays:
- Referral link with copy functionality
- Performance metrics (clicks, leads, sales)
- Commission earnings and payout status
- Coupon codes (with optional self-service creation)
- Marketing resources and creatives

## Integration Flow

```
Your Server                    Affonso API                    Your Frontend
     │                              │                              │
     │  POST /v1/embed/token        │                              │
     │  (with user data)            │                              │
     │─────────────────────────────▶│                              │
     │                              │                              │
     │◀─────────────────────────────│                              │
     │  { publicToken, link }       │                              │
     │                              │                              │
     │──────────────────────────────┼─────────────────────────────▶│
     │                              │         Render iframe        │
     │                              │         with token           │
```

## Step 1: Generate Token

Call the API from your server to create a short-lived access token.

```bash
curl -X POST "https://api.affonso.io/v1/embed/token" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "programId": "prog_abc123",
    "partner": {
      "email": "user@example.com",
      "name": "Jane Smith"
    }
  }'
```

**Response:**

```json
{
  "success": true,
  "data": {
    "publicToken": "tok_xyz789...",
    "expiresAt": "2024-01-15T10:30:00Z",
    "link": "https://yoursite.com?via=jane-smith"
  }
}
```

### Parameters

| Field | Required | Description |
|-------|----------|-------------|
| `programId` | Yes | Your affiliate program ID |
| `partner.email` | Yes | User's email (creates affiliate if new) |
| `partner.name` | No | Display name for the affiliate |
| `partner.image` | No | Avatar URL |
| `groupId` | No | Assign to specific commission group |

<Note>
  New users are automatically registered as affiliates and approved for your program.
</Note>

## Step 2: Render the Dashboard

Add the iframe to your frontend using the token from Step 1.

```html
<iframe
  src="https://affonso.io/embed/referrals?token=tok_xyz789..."
  width="100%"
  height="600"
  frameborder="0"
  allow="clipboard-write"
/>
```

### Next.js Implementation

```tsx
// app/referrals/page.tsx
async function getToken(user: User) {
  const res = await fetch('https://api.affonso.io/v1/embed/token', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${process.env.AFFONSO_API_KEY}`,
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      programId: process.env.AFFONSO_PROGRAM_ID,
      partner: { email: user.email, name: user.name },
    }),
  });
  return res.json();
}

export default async function ReferralsPage() {
  const user = await getCurrentUser();
  const { data } = await getToken(user);

  return (
    <iframe
      src={`https://affonso.io/embed/referrals?token=${data.publicToken}`}
      className="w-full h-screen border-0"
      allow="clipboard-write"
    />
  );
}
```

## Token Lifecycle

| Property | Details |
|----------|---------|
| Validity | 30 minutes |
| Refresh | Generate new token on each page load |
| Cleanup | Old tokens are automatically invalidated |

<Warning>
  Always generate tokens server-side. Never expose your API key to the client.
</Warning>

## Theming

The dashboard inherits your brand colors from Portal Settings:

- **Primary Color** - Buttons, links, accents
- **Secondary Color** - Highlights, backgrounds

Configure colors in HEX format (e.g., `#881337`) in your Affonso dashboard under Portal Settings.

## Affiliate Groups

Assign users to different commission tiers by passing a `groupId`:

```json
{
  "programId": "prog_abc123",
  "partner": {
    "email": "vip@example.com"
  },
  "groupId": "grp_premium"
}
```

Users without a specified group are assigned to your program's default group.
